<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Valentine?</title>

<style>
*{box-sizing:border-box}
body{
  margin:0; min-height:100svh; overflow:hidden; background:#000;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  -webkit-tap-highlight-color:transparent;
}

/* Background slideshow */
.slideshow{position:fixed; inset:0; z-index:-1}
.slide{position:absolute; inset:0; background-size:cover; background-position:center; opacity:0; animation:fade 40s infinite}
.slide:nth-child(1){background-image:url("bg1.jpg"); animation-delay:0s}
.slide:nth-child(2){background-image:url("bg2.jpg"); animation-delay:8s}
.slide:nth-child(3){background-image:url("bg3.jpg"); animation-delay:16s}
.slide:nth-child(4){background-image:url("bg4.jpg"); animation-delay:24s}
.slide:nth-child(5){background-image:url("bg5.jpg"); animation-delay:32s}
@keyframes fade{0%{opacity:0}10%{opacity:1}40%{opacity:1}50%{opacity:0}100%{opacity:0}}

.container{min-height:100svh; display:grid; place-items:center; padding:16px}
.card{
  width:min(520px,100%);
  background:rgba(255,255,255,.72);
  backdrop-filter:blur(10px);
  -webkit-backdrop-filter:blur(10px);
  border-radius:26px;
  padding:22px 20px 26px;
  text-align:center;
  box-shadow:0 20px 45px rgba(0,0,0,.25);
}
h1{margin:6px 0 8px; font-size:34px; color:#d6336c}
p{margin:0 0 14px; font-size:17px; color:#333}

.buttons{
  position:relative;
  height:220px;
  max-width:420px;
  margin:10px auto 0;
}

button{
  position:absolute;
  min-width:170px;
  padding:14px 22px;
  border:none;
  border-radius:999px;
  font-size:18px;
  font-weight:650;
  cursor:pointer;
  user-select:none;
  touch-action:manipulation;
}

#yes{background:#ff4d6d; color:#fff; z-index:1}
#no{background:#adb5bd; color:#fff; z-index:3}

.note{margin-top:12px; font-size:13px; color:#444}
</style>
</head>

<body>
<div class="slideshow">
  <div class="slide"></div><div class="slide"></div><div class="slide"></div>
  <div class="slide"></div><div class="slide"></div>
</div>

<div class="container">
  <div class="card" id="card">
    <h1>Hi Amber 💌</h1>
    <p>Will you be my Valentine?</p>

    <div class="buttons" id="arena">
      <button id="yes">YES 💖</button>
      <button id="no">NO 🙃</button>
    </div>

    <div class="note">careful, dont anyhow press wrong ah bao</div>
  </div>
</div>

<script>
const arena = document.getElementById("arena");
const yesBtn = document.getElementById("yes");
const noBtn  = document.getElementById("no");
const card   = document.getElementById("card");

/* --------- State --------- */
let noClicks = 0;                 // 0 -> try1, 1 -> try2, 2 -> try3
let mode = "ERRATIC";             // ERRATIC | SLOW | STATIC

let yesX = 0, yesY = 0;           // YES position in arena coords (px)
let vx = 0, vy = 0;               // velocity for ERRATIC (px/s)
let tx = 0, ty = 0;               // target for SLOW
let last = 0;
let running = true;

/* --------- Helpers --------- */
function clamp(n,min,max){ return Math.max(min, Math.min(max, n)); }

function arenaMetrics(){
  const a = arena.getBoundingClientRect();
  const w = yesBtn.offsetWidth;
  const h = yesBtn.offsetHeight;

  // Inner bounds keep things away from the extreme edges so it never “sticks” to side.
  const padX = 36;
  const padTop = 18;
  const padBottom = 26;

  return {
    aw: a.width, ah: a.height,
    yw: w, yh: h,
    minX: padX,
    maxX: Math.max(padX, a.width  - w - padX),
    minY: padTop,
    maxY: Math.max(padTop, a.height - h - padBottom)
  };
}

function applyPositions(){
  // YES
  yesBtn.style.left = `${yesX}px`;
  yesBtn.style.top  = `${yesY}px`;

  // NO blocks by sitting directly on top of YES (centered)
  const nx = yesX + (yesBtn.offsetWidth - noBtn.offsetWidth)/2;
  const ny = yesY + (yesBtn.offsetHeight - noBtn.offsetHeight)/2;
  noBtn.style.left = `${nx}px`;
  noBtn.style.top  = `${ny}px`;
}

function randomInnerSpot(m){
  return {
    x: m.minX + Math.random() * Math.max(1, (m.maxX - m.minX)),
    y: m.minY + Math.random() * Math.max(1, (m.maxY - m.minY))
  };
}

function setModeFromNoClicks(){
  if (noClicks === 0) mode = "ERRATIC";
  else if (noClicks === 1) mode = "SLOW";
  else mode = "STATIC";
}

function resetForMode(){
  const m = arenaMetrics();
  // Start near center for all modes
  yesX = clamp((m.aw - m.yw)/2, m.minX, m.maxX);
  yesY = clamp(20, m.minY, m.maxY);

  if (mode === "ERRATIC"){
    // fast + chaotic but bounded
    vx = (Math.random()*2 - 1) * 420; // px/s
    vy = (Math.random()*2 - 1) * 320;
  }
  if (mode === "SLOW"){
    const s = randomInnerSpot(m);
    tx = s.x; ty = s.y;
  }
}

/* --------- Animation loop (single loop, cannot desync) --------- */
function tick(ts){
  if (!running) return;

  if (!last) last = ts;
  const dt = Math.min(40, ts - last) / 1000; // seconds
  last = ts;

  const m = arenaMetrics();

  if (mode === "ERRATIC"){
    // jitter acceleration
    vx += (Math.random()*2 - 1) * 700 * dt;
    vy += (Math.random()*2 - 1) * 700 * dt;

    // cap speed
    const sp = Math.hypot(vx, vy);
    const maxSp = 700;
    if (sp > maxSp){ vx *= maxSp/sp; vy *= maxSp/sp; }

    yesX += vx * dt;
    yesY += vy * dt;

    // hard bounce inside inner bounds
    if (yesX < m.minX){ yesX = m.minX; vx *= -0.92; }
    if (yesX > m.maxX){ yesX = m.maxX; vx *= -0.92; }
    if (yesY < m.minY){ yesY = m.minY; vy *= -0.92; }
    if (yesY > m.maxY){ yesY = m.maxY; vy *= -0.92; }
  }

  if (mode === "SLOW"){
    const dx = tx - yesX;
    const dy = ty - yesY;
    const d  = Math.hypot(dx, dy);

    if (d < 10){
      const s = randomInnerSpot(m);
      tx = s.x; ty = s.y;
    } else {
      const speed = 120; // px/s
      yesX += (dx/d) * speed * dt;
      yesY += (dy/d) * speed * dt;
      yesX = clamp(yesX, m.minX, m.maxX);
      yesY = clamp(yesY, m.minY, m.maxY);
    }
  }

  if (mode === "STATIC"){
    // keep centered (in case of resize)
    yesX = clamp((m.aw - m.yw)/2, m.minX, m.maxX);
    yesY = clamp(20, m.minY, m.maxY);
  }

  applyPositions();
  requestAnimationFrame(tick);
}

/* --------- Click logic --------- */
noBtn.addEventListener("click", () => {
  noClicks++;

  if (noClicks === 1){
    alert("😳 Careful ah… still got 2 chances.");
  } else if (noClicks === 2){
    alert("🚨 LAST WARNING.\nClick NO again and the date is cancelled.");
  } else {
    running = false;
    card.innerHTML = `
      <h1 style="color:#888;">Date Cancelled</h1>
      <p>You pressed NO 3 times 😔</p>
      <p style="color:#666;">dont anyhow press next time</p>
    `;
    return;
  }

  setModeFromNoClicks();
  resetForMode();
  applyPositions();
});

yesBtn.addEventListener("click", () => {
  running = false;
  card.innerHTML = `
    <h1>💘 It’s a Date 💘</h1>
    <p><strong>14 February</strong></p>
    <p>Dinner at <strong>Le Petit Paris</strong></p>
    <p style="font-size:15px;color:#444;">
      15 Swan Lake Avenue<br>
      Opera Estate, Singapore 455711
    </p>
    <p style="margin-top:12px;color:#555;">– Bryan</p>
  `;
});

/* --------- Init --------- */
window.addEventListener("load", () => {
  setModeFromNoClicks();
  resetForMode();
  applyPositions();
  requestAnimationFrame(tick);
});

window.addEventListener("resize", () => {
  // keep within bounds on resize/rotation
  const m = arenaMetrics();
  yesX = clamp(yesX, m.minX, m.maxX);
  yesY = clamp(yesY, m.minY, m.maxY);
  applyPositions();
});
</script>
</body>
</html>
